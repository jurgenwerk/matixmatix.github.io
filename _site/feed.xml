<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.0.3">Jekyll</generator><link href="/feed.xml" rel="self" type="application/atom+xml" /><link href="/" rel="alternate" type="text/html" /><updated>2019-01-14T08:18:19+01:00</updated><id>/</id><title>codeandtechno</title><subtitle>Matic Jurgliƒç is a computer person who specializes in avant-garde internet applications.</subtitle><author><name>Matic Jurgliƒç</name></author><entry><title>If Marcus Aurelius were a software developer</title><link href="/posts/stoicism-for-developers/" rel="alternate" type="text/html" title="If Marcus Aurelius were a software developer" /><published>2019-01-13T00:00:00+01:00</published><updated>2019-01-13T00:00:00+01:00</updated><id>/posts/stoicism-for-developers</id><content type="html" xml:base="/posts/stoicism-for-developers/">&lt;p&gt;As a practitioner of stoicism, one of my favourite teachings is an adage from Marcus Aurelius‚Äôs &lt;a href=&quot;https://en.wikipedia.org/wiki/Meditations&quot;&gt;Meditations&lt;/a&gt;, which speaks about setting the stoic mindset the minute one wakes up in the morning.&lt;/p&gt;

&lt;p&gt;Living a life of a software developer, I‚Äôve recently been entertaining the idea of transforming Marcus‚Äôs words of wisdom into developer lingo. By taking this general philosophy and narrow it down it to my professional environment, I helped myself to strengthen my virtue at work.&lt;/p&gt;

&lt;p&gt;Let‚Äôs first take a look at the original:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;When you wake up in the morning, tell yourself: the people I deal with today will be meddling, ungrateful, arrogant, dishonest, jealous and surly. They are like this because they can‚Äôt tell good from evil. But I have seen the beauty of good, and the ugliness of evil, and have recognized that the wrongdoer has a nature related to my own - not of the same blood and birth, but the same mind, and possessing a share of the divine. And so none of them can hurt me. No one can implicate me in ugliness. Nor can I feel angry at my relative, or hate him. We were born to work together like feet, hands and eyes, like the two rows of teeth, upper and lower. To obstruct each other is unnatural. To feel anger at someone, to turn your back on him: these are unnatural.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Now let‚Äôs see how we could adapt this for stoic developers.&lt;/p&gt;

&lt;h3 id=&quot;when-you-wake-up-in-the-morning-tell-yourself&quot;&gt;When you wake up in the morning, tell yourself:&lt;/h3&gt;

&lt;p&gt;&lt;i&gt;The software and processes I will deal with today will be buggy, broken, undocumented and written in contexts whose traces have been lost forever. I will be managed by unreasonable bosses who lost touch with reality, and I will deal with abysmal implementations containing blatant security holes.While trying to catch aggressive deadlines, I will continuously be running into unexplainable issues, halting my progress. Customers will be reporting problems that fall into the category of edge cases I would have never imagined.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;&lt;i&gt;My job is like this because I chose the life of a problem solver, and I am capable of organizing and solving the issues in a calm and focused manner. Moreover, I have learned to thrive in these conditions.&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;&lt;i&gt;These properties of software development are natural. To feel anxiety, frustration and anger at this job, is unnatural.&lt;/i&gt;&lt;/p&gt;</content><category term="posts" /><summary>As a practitioner of stoicism, one of my favourite teachings is an adage from Marcus Aurelius‚Äôs Meditations, which speaks about setting the stoic mindset the minute one wakes up in the morning.</summary></entry><entry><title>Making a concrete coffee table</title><link href="/posts/concrete-coffee-table/" rel="alternate" type="text/html" title="Making a concrete coffee table" /><published>2019-01-05T00:00:00+01:00</published><updated>2019-01-05T00:00:00+01:00</updated><id>/posts/concrete-coffee-table</id><content type="html" xml:base="/posts/concrete-coffee-table/">&lt;p&gt;Coffee tables are arguably the most important piece of furniture in a living room. They hold much more than coffee, and are a centerpiece around which the most intimate kind of socialising happens.&lt;/p&gt;

&lt;p&gt;Read on to see how to make one out of concrete.&lt;/p&gt;

&lt;figure class=&quot;&quot;&gt;
&lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-final-2.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-final-2.jpg&quot; /&gt;&lt;/a&gt;
  &lt;figcaption&gt;Finished concrete coffee table, weighing around 100 kilograms.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;After some napkin math, I decided on the measures. The calculation was I needed around 5 bags of cement. I was exactly right.&lt;/p&gt;

&lt;h2 id=&quot;mold-assembly&quot;&gt;Mold assembly&lt;/h2&gt;

&lt;figure class=&quot;third&quot;&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-saw.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-saw.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-mold.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-mold.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-mold-complete.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-mold-complete.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Putting some stuff together.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;For projects like this you usually want to go with melamine wood (white boards on the upper pictures). It‚Äôs not really wood though, it‚Äôs just diced wooden garbage mashed back together into a solid shape and covered with a smooth layer. It‚Äôs cheap, easy to cut, and most importantly, doesn‚Äôt bend when wet.&lt;/p&gt;

&lt;p&gt;I didn‚Äôt have enough melamine, so I used some other, ‚Äúnormal‚Äù wood that was laying around. I knew this wood would bend after getting in contact with wet concrete. I was just hoping the concrete would harden fast enough, which fortunately it did.&lt;/p&gt;

&lt;p&gt;If you plan on making a reusable mold like this, make sure to use melamine wood only.&lt;/p&gt;

&lt;h2 id=&quot;pouring-in-the-concrete&quot;&gt;Pouring in the concrete&lt;/h2&gt;

&lt;p&gt;Action time.&lt;/p&gt;

&lt;p&gt;I used a cement mix (with sand aggregate already added) and poured it into the wooden enclosure.&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-1.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-1.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-2.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-2.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-3.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-mold-concrete-3.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;With concrete, clamps are your friends. Always.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;dismantling&quot;&gt;Dismantling&lt;/h2&gt;

&lt;p&gt;Aah, always the best part.&lt;/p&gt;

&lt;p&gt;After two days it was time to take the mold apart. I didn‚Äôt do a particular good job with getting rid of the air bubbles, and since I was aiming for a smooth surface, I needed to fill the gaps with slurry (3rd picture below).&lt;/p&gt;

&lt;p&gt;Slurry is a term for cement paste mixed with a chemical that helps it bond with the already dry concrete.&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-1.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-1.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-2.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-2.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-3.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-dismantling-3.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;polishing&quot;&gt;Polishing&lt;/h2&gt;

&lt;p&gt;For the purpose of polishing I got myself a simple wet concrete polisher from eBay. The polisher uses diamond pads with different grits (you switch them from lower to higher numbers).&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-1.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-1.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-2.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-2.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-3.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-polishing-3.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The polishing process is done on a watery surface because that way it‚Äôs more efficient and does less damage to the pads. It also prevents toxic concrete dust from entering your lungs and turning them into a stone.&lt;/p&gt;

&lt;h2 id=&quot;finalizing-and-staining&quot;&gt;Finalizing and staining&lt;/h2&gt;

&lt;p&gt;After polishing, this is how the table looked.&lt;/p&gt;

&lt;p&gt;At this point the table needs to be stained with a protective liquid that prevents the concrete from soaking up spilled wine and whisky.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-pre-stain.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-pre-stain.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/coffeetable-post/concrete-coffee-table-staining.jpg&quot;&gt;&lt;img src=&quot;/images/coffeetable-post/concrete-coffee-table-staining.jpg&quot; /&gt;&lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;It was a bad decision to stain it with a brush, because brushmarks are seen under some angles in bright light. For mark-less coating, it‚Äôs better to use a dense roller.&lt;/p&gt;</content><category term="posts" /><summary>Coffee tables are arguably the most important piece of furniture in a living room. They hold much more than coffee, and are a centerpiece around which the most intimate kind of socialising happens.</summary></entry><entry><title>What is SaaS white labeling and how to do it?</title><link href="/posts/saas-whitelabeling/" rel="alternate" type="text/html" title="What is SaaS white labeling and how to do it?" /><published>2018-12-26T00:00:00+01:00</published><updated>2018-12-26T00:00:00+01:00</updated><id>/posts/saas-whitelabeling</id><content type="html" xml:base="/posts/saas-whitelabeling/">&lt;p&gt;Depending on your online business, white labeling can turn out to be a fantastic business model. This applies especially when your target customers are actually &lt;b&gt;customers who have their own customers&lt;/b&gt;, for example agencies, consultancies and client-oriented businesses.&lt;/p&gt;

&lt;p&gt;In this case there is a real chance that adding support for white labeling in your product will improve your chances of attracting advanced users and position your product higher in the eyes of corporate customers (i.e. those who can pay top dollar).&lt;/p&gt;

&lt;h3 id=&quot;but-what-exactly-is-white-labeling&quot;&gt;But what exactly is white labeling?&lt;/h3&gt;

&lt;p&gt;White labeling means taking a blank product and slapping a label for another company on it.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/whitelabel-post/whitelabeled-bottles.jpg&quot;&gt;&lt;img src=&quot;/images/whitelabel-post/whitelabeled-bottles.jpg&quot; /&gt;&lt;/a&gt;
    &lt;center&gt;
    &lt;figcaption&gt;&lt;/figcaption&gt;&lt;/center&gt;
&lt;/figure&gt;

&lt;p&gt;It means other companies can take your (online, in this case) product and brand it as their own.&lt;/p&gt;

&lt;h3 id=&quot;white-labeled-saas-example&quot;&gt;White labeled SaaS example&lt;/h3&gt;

&lt;p&gt;Let‚Äôs imagine you built a website performance tracker that makes reports of websites‚Äô speed. On one hand, you have individual customers that use your service to track their own websites. On the other hand, there are many web performance consultancies and agencies who make a living tuning &lt;em&gt;other&lt;/em&gt; people‚Äôs (i.e. their customers‚Äô) websites. To deliver reports, they have 3 options:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Build their own website tracking solution. This is expensive to build, and expensive to maintain. Not all businesses are in a position to afford and maintain it.&lt;/li&gt;
  &lt;li&gt;Use a 3rd party solution (like yours). Their clients will notice they are relying on an external service, which may impair their trust.&lt;/li&gt;
  &lt;li&gt;Use a 3rd party solution (like yours), but brand it (white label) as their own. Their clients will think the reporting solution (which is actually yours, but branded differently) is an integral part of their service, which may make them look better in their clients‚Äô eyes.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;white-labeling-settings-in-saas&quot;&gt;White labeling settings in SaaS&lt;/h3&gt;

&lt;p&gt;White labeling should be approached the same way as &lt;b&gt;internationalization&lt;/b&gt;. The principle is the same. Configurations can be saved in asset folders or in a database, and conditionally shown depending on the user and their settings.&lt;/p&gt;

&lt;p&gt;Here is an example of how we did these settings at &lt;a href=&quot;https://nightwatch.io&quot; target=&quot;_blank&quot;&gt;Nightwatch.io&lt;/a&gt;:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/whitelabel-post/whitelabel-settings-example.png&quot;&gt;&lt;img src=&quot;/images/whitelabel-post/whitelabel-settings-example.png&quot; /&gt;&lt;/a&gt;
    &lt;center&gt;
    &lt;figcaption&gt;&lt;/figcaption&gt;&lt;/center&gt;
&lt;/figure&gt;

&lt;h3 id=&quot;white-label-subdomain&quot;&gt;White label (sub)domain&lt;/h3&gt;

&lt;p&gt;This is the entry point to a white labeled SaaS product.&lt;/p&gt;

&lt;p&gt;Your customers who wish to offer your product branded as their own will want to customize its URL.&lt;/p&gt;

&lt;p&gt;The DNS part is easy, usually solved with a &lt;em&gt;CNAME&lt;/em&gt; record. Returning to our previous example, let‚Äôs suppose that your SaaS product URL is &lt;em&gt;WebPerformanceTracking.com&lt;/em&gt;. Let‚Äôs suppose that one of your customers, who runs their consultancy at WebPerfCompany.com wants to white label your service and make it accessible at &lt;em&gt;tracker.WebPerfCompany.com&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;What you can do is set up a &lt;em&gt;whitelabel.WebPerformanceTracking.com&lt;/em&gt;, point it to your server and instruct your customer to set up a CNAME record on their &lt;em&gt;tracker.webperfcompany.com&lt;/em&gt; subdomain. This will route the requests to their white labeled service back to your server.&lt;/p&gt;

&lt;h3 id=&quot;theres-a-problem-though&quot;&gt;There‚Äôs a problem though&lt;/h3&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/whitelabel-post/page-not-secure.png&quot;&gt;&lt;img src=&quot;/images/whitelabel-post/page-not-secure.png&quot; /&gt;&lt;/a&gt;
    &lt;center&gt;
    &lt;figcaption&gt;&lt;/figcaption&gt;&lt;/center&gt;
&lt;/figure&gt;

&lt;p&gt;The described connection to your customer‚Äôs white labeled service is unsecure (non-https). Since browsers are complaining about it more and more, and you don‚Äôt want to break clients‚Äôs trust, it only makes sense to secure it.&lt;/p&gt;

&lt;p&gt;To make secure connections from your customers‚Äô white labeled domains to your server, you have two options.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Convince your customer to send you a cetificate for the white labeled domain and use it on your server. This is not really convenient nor desirable, because it‚Äôs a hard to maintain, hard to scale, needs a lot of support and it makes you a keeper of foreign certificate, which brings extra burderns.&lt;/li&gt;
  &lt;li&gt;Use or build a proxying service with a middleware or CDN that creates Let‚Äôs Encrypt certificates on the fly.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;If you want hassle free whitelabeling, then you want to go with option 2. Depending on your scale, you probably want to use a 3rd party solution for that.&lt;/p&gt;

&lt;p&gt;How this usually works is that your customer still has to create a CNAME record, but there is an additional step you have to make. You have to report the white labeled domain to your selected proxying service via their API so they could setup the certificate in the background and do the necessary routing.&lt;/p&gt;

&lt;p&gt;CloudFlare is probably the simplest service you can use to secure white labeled connections, but at the time of writing, it‚Äôs available only as a part of an &lt;a href=&quot;https://www.cloudflare.com/saas/&quot;&gt;expensive corporate plan&lt;/a&gt;. Alternatively, you can use CDN services, like &lt;a href=&quot;https://fly.io/&quot;&gt;Fly.io&lt;/a&gt; or &lt;a href=&quot;https://zeit.co&quot;&gt;Zeit&lt;/a&gt; to deploy a proxying app which responds to secure whitelabel connections and serves data from your origin server.&lt;/p&gt;

&lt;h3 id=&quot;final-step&quot;&gt;Final step&lt;/h3&gt;

&lt;p&gt;When you reached the stage where connections from white labeled domains are succesfully hitting your server, it‚Äôs time to write some application logic that matches a hostname against a white labeled account and decorates the requests with the info on which white labeled account it belongs to.&lt;/p&gt;

&lt;p&gt;When you have this information for every request, you can easily use it inside your application interface to show white labeled branding, e.g. custom design, logos, emails, texts and other customly branded pieces of the app.&lt;/p&gt;</content><category term="posts" /><summary>Depending on your online business, white labeling can turn out to be a fantastic business model. This applies especially when your target customers are actually customers who have their own customers, for example agencies, consultancies and client-oriented businesses.</summary></entry><entry><title>Partial, resource-related dumps in PostgreSQL</title><link href="/posts/partial-resource-dump-postgres/" rel="alternate" type="text/html" title="Partial, resource-related dumps in PostgreSQL" /><published>2018-03-29T00:00:00+02:00</published><updated>2018-03-29T00:00:00+02:00</updated><id>/posts/partial-resource-dump-postgres</id><content type="html" xml:base="/posts/partial-resource-dump-postgres/">&lt;p&gt;Sometimes we find ourselves in a need for copying and restoring a specific set of data belonging to a common parent resource. For example, we want to connect to the production server, pull down fresh data related only to the specified user and restore it to our development database to debug an issue or just develop new features. When your database is tiny, you could just restore the whole thing, but once it grows, the complete restoration is out of the question, especially when you need to do it often.&lt;/p&gt;

&lt;p&gt;Here‚Äôs a simplified bash script I wrote that downloads everything belonging to the application user from the production database, deletes stale user data from the local development database and replaces it with the fresh data.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/sh&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Usage: ./script/restore_user 100&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;USER_ID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;DATE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;date +%Y-%m-%d&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;SQL_FILENAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;data_user_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;USER_ID&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;_&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;DATE&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;.sql

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-- Preparing a data dump file for the specified user...&quot;&lt;/span&gt;
ssh admin@db.myapp.com /bin/sh &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;EOT &amp;gt; $SQL_FILENAME
  echo &quot;Copying user...&quot; &amp;gt;&amp;amp;2
  echo &quot;COPY users FROM STDIN;&quot;
  psql -h db.myapp.com -U myusername mydatabase -c &quot;COPY (
    SELECT users.*
    FROM users
    WHERE id = ${USER_ID}
  ) TO STDOUT;&quot;
  echo &quot;\\.&quot;

  echo &quot;Copying user‚Äôs posts...&quot; &amp;gt;&amp;amp;2
  echo &quot;COPY posts FROM STDIN;&quot;
  psql -h db.myapp.com -U myusername mydatabase -c &quot;COPY (
    SELECT posts.*
    FROM posts
    WHERE user_id = ${user_id}
  ) TO STDOUT;&quot;
  echo &quot;\\.&quot;

  echo &quot;Copying post‚Äôs tags ...&quot; &amp;gt;&amp;amp;2
  echo &quot;COPY tags FROM STDIN;&quot;
  psql -h db.myapp.com -U myusername mydatabase -c &quot;COPY (
    SELECT tags.*
    FROM tags
    INNER JOIN posts ON posts.id = tags.post_id
    WHERE posts.user_id = ${user_id}
  ) TO STDOUT;&quot;
  echo &quot;\\.&quot;
EOT
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Let‚Äôs comment on what‚Äôs happening here. What we‚Äôre doing is essentially using Postgres‚Äôs &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; function which is useful for moving data around tables. Usually it‚Äôs used to produce individual CSV files separately for each table, which are then individually restored using &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY FROM&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;Since this function is also able to read from the &lt;code class=&quot;highlighter-rouge&quot;&gt;STDIN&lt;/code&gt;, we bundle all &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY&lt;/code&gt; commands together (using the  &lt;code class=&quot;highlighter-rouge&quot;&gt;.\&lt;/code&gt; which indicates the end of the input). Local PostgreSQL will then see sequences of &lt;code class=&quot;highlighter-rouge&quot;&gt;COPY FROM STDIN&lt;/code&gt;, then data, then &lt;code class=&quot;highlighter-rouge&quot;&gt;.\&lt;/code&gt;, indicating it‚Äôs done. We do this to avoid making multiple table-specific CSV files. Instead, we just put everything into one big SQL file.&lt;/p&gt;

&lt;p&gt;This was just the first part of the script. Now that we have the necessary data in an SQL file, we have to make place for it and restore it to our local database.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-- Deleting old user data...&quot;&lt;/span&gt;
psql -d mydb_dev -c &lt;span class=&quot;s2&quot;&gt;&quot;
  DELETE FROM tags WHERE tags.id IN (
    SELECT tags.id
    FROM tags
    INNER join posts ON posts.id = tags.post_id
    WHERE user_id = &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
  );

  DELETE FROM posts where user_id = &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;
  DELETE FROM users where id = &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-- Restoring fresh user data...&quot;&lt;/span&gt;
psql -d mydb_dev &amp;lt; &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SQL_FILENAME&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-- Deleting temp data...&quot;&lt;/span&gt;
rm &lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SQL_FILENAME&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-- Done. Enjoy.&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Since this is only a partial dump related to a common resource or ancestor (application user, in this case), we need to make sure we also have all other data in our development database that the application needs to run and doesn‚Äôt belong to the user. Depending on your setup, you could easily restore those tables using &lt;code class=&quot;highlighter-rouge&quot;&gt;pg_dump&lt;/code&gt; command where you explicitly specify the tables.
But when you need to refresh only a subset of local data, a script like this comes in really handy.&lt;/p&gt;</content><category term="posts" /><summary>Sometimes we find ourselves in a need for copying and restoring a specific set of data belonging to a common parent resource. For example, we want to connect to the production server, pull down fresh data related only to the specified user and restore it to our development database to debug an issue or just develop new features. When your database is tiny, you could just restore the whole thing, but once it grows, the complete restoration is out of the question, especially when you need to do it often.</summary></entry><entry><title>CloudFront redirections for your SPA using AWS Lambda (A/B testing, maintenance page,‚Ä¶)</title><link href="/posts/cloudfront-redirections-lambda/" rel="alternate" type="text/html" title="CloudFront redirections for your SPA using AWS Lambda (A/B testing, maintenance page,...)" /><published>2017-09-10T00:00:00+02:00</published><updated>2017-09-10T00:00:00+02:00</updated><id>/posts/cloudfront-redirections-lambda</id><content type="html" xml:base="/posts/cloudfront-redirections-lambda/">&lt;p&gt;For many people, the stack of choice for deploying a JavaScript application (SPA) or other assets is to save them to Amazon S3 and serve it to the world over Amazon CloudFront CDN. With its cached edges around the world, it makes sure the users‚Äô browsers are able to download your application in the most efficient way possible.&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/lambda-post/cloudfront-map.png&quot;&gt;&lt;img src=&quot;/images/lambda-post/cloudfront-map.png&quot; /&gt;&lt;/a&gt;
    &lt;center&gt;
    &lt;figcaption&gt;At the time of writing, CloudFront offers around 100 edge locations around the globe.&lt;/figcaption&gt;&lt;/center&gt;
&lt;/figure&gt;

&lt;p&gt;A possible drawback of this application/server architecture is that your JavaScript application or other content is cached in various cache servers placed globally, and that seems problematic in cases where you want to suddenly place a redirection switch - serving your users something else, depending on some condition or request. You‚Äôre not in complete control of your server(s), and cache invalidations and DNS changes could take forever, especially in urgencies.&lt;/p&gt;

&lt;p&gt;One of these cases is showing a ‚Äúmaintenance site‚Äù. You know - those ‚ÄúWe‚Äôll be back shortly.‚Äù notices, when engineers are either sweatingly salvaging a botched back-end or just performing regular, scheduled maintenance.&lt;/p&gt;

&lt;p&gt;A popular technique in SPAs is to detect these adversities by listening for &lt;code class=&quot;highlighter-rouge&quot;&gt;5xx&lt;/code&gt; responses from the API server and rendering a ‚ÄúMaintenance‚Äù message. It‚Äôs a valid approach, but this comes with a couple of assumptions which make the problem detection unreliable.&lt;/p&gt;

&lt;p&gt;Two major assumptions:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;JavaScript application works OK,&lt;/li&gt;
  &lt;li&gt;Server is responding with HTTP code &lt;code class=&quot;highlighter-rouge&quot;&gt;5xx&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But, what if your build system deploys a broken bundle which doesn‚Äôt work in a browser anymore (or maybe it breaks only in specific browsers)? What if your async API requests are timeouting and you don‚Äôt get any response?&lt;/p&gt;

&lt;p&gt;In these cases it‚Äôs best to have a manual switch &lt;strong&gt;on the server level&lt;/strong&gt; that puts your website into maintenance mode while you do the fixing.&lt;/p&gt;

&lt;p&gt;With CloudFront you‚Äôre able to achieve this by using &lt;a href=&quot;http://docs.aws.amazon.com/lambda/latest/dg/lambda-edge.html&quot;&gt;Lambda@Edge&lt;/a&gt; functions (an extension of AWS Lambda) in the Viewer Request trigger, which triggers BEFORE the CloudFront cache is checked and returned. Within this function you could do many different things, for example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Inspect cookies, User-Agent, headers,‚Ä¶&lt;/li&gt;
  &lt;li&gt;Do HTTP redirections, personalize and generate responses depending on location and various other criteria, serve different content for crawler bots,&lt;/li&gt;
  &lt;li&gt;Make network calls to external resources (e.g., authorization).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Returning to the maintenance page switch, we could write a Lambda function like this:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;handler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;302&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;statusDescription&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;Found&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;location&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;Location&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;https://my-site.com/maintenance.html&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;When we want to put this redirection to work, we simply assign its ARN to our CloudFront distribution in its behaviour settings:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/lambda-post/cloudfront-lambda-redirect.png&quot;&gt;&lt;img src=&quot;/images/lambda-post/cloudfront-lambda-redirect.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;CloudFront distribution behaviour settings.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;‚Ä¶ and remove it once you don‚Äôt want the redirection anymore. The change is usually processed within a very short period of time (which is usually not the case when saving adjustments in CloudFront distributions).&lt;/p&gt;

&lt;p&gt;This mechanism can be used for a lot of other practical implementations, like A/B testing redirections, logging and handling web client specifics.&lt;/p&gt;</content><category term="posts" /><summary>For many people, the stack of choice for deploying a JavaScript application (SPA) or other assets is to save them to Amazon S3 and serve it to the world over Amazon CloudFront CDN. With its cached edges around the world, it makes sure the users‚Äô browsers are able to download your application in the most efficient way possible.</summary></entry><entry><title>List and download Dropbox files with Ruby</title><link href="/posts/download-dropbox-files-ruby/" rel="alternate" type="text/html" title="List and download Dropbox files with Ruby" /><published>2017-03-12T00:00:00+01:00</published><updated>2017-03-12T00:00:00+01:00</updated><id>/posts/download-dropbox-files-ruby</id><content type="html" xml:base="/posts/download-dropbox-files-ruby/">&lt;p&gt;If you find yourself in a need for downloading contents from Dropbox (or whole folders), a sane and quick way would be
to visit their web interface and select to download (compressed) files.&lt;/p&gt;

&lt;p&gt;But what about when you don‚Äôt have a password to access the interface, but you do have an API access token?&lt;/p&gt;

&lt;p&gt;I put together a small script to help you with that. Here it goes.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;fileutils&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;dropbox_sdk&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# dropbox-sdk-ruby gem&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;DropboxClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;access_token&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Recursively traverse the contents in dir_path&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;list_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dir_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;metadata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dir_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;metadata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;contents&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;flat_map&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;is_dir&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;list_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# A folder on your local machine where contents will be downloaded to&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dump_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;dropbox_dump&quot;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# List files for the root path (&#39;/&#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;file_paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;list_files&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Now we have the paths of all the files in the folder we provided (root folder). Let‚Äôs download them all.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;download_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;full_file_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exist?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;File &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_file_path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists&quot;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metadata&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;get_file_and_metadata&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;full_folder_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dirname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;FileUtils&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;mkdir_p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_folder_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full_file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;wb&#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contents&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Download every file in file_paths to specified local dump folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;file_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;each_with_index&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Downloading &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; ...&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;download_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;puts&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; to go&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;</content><category term="posts" /><summary>How to use Ruby Dropbox SDK to download files.</summary></entry><entry><title>Tips for writing an indie e-book</title><link href="/posts/tips-for-writing-an-indie-ebook/" rel="alternate" type="text/html" title="Tips for writing an indie e-book" /><published>2017-01-29T00:00:00+01:00</published><updated>2017-01-29T00:00:00+01:00</updated><id>/posts/tips-for-writing-an-indie-ebook</id><content type="html" xml:base="/posts/tips-for-writing-an-indie-ebook/">&lt;p&gt;With the advent of solopreneurship, &lt;a href=&quot;https://www.indiehackers.com&quot;&gt;indie hacking&lt;/a&gt; and side hustling, writing and self-publishing niche e-books became a well recognized source of passive income, and, more importantly, an effective sales funnel to your main business - be it a personal brand, consulting gigs, or various services.&lt;/p&gt;

&lt;p&gt;A bit less than a year ago, I set myself up for my first serious writing adventure. Out of appreciation and internal need to evangelize the coolness of &lt;a href=&quot;http://emberjs.com/&quot;&gt;Ember.js&lt;/a&gt; (a web programming framework), a technical e-book &lt;a href=&quot;http://emberjs-book.com/&quot;&gt;Front-end revolution with Ember.js&lt;/a&gt; was born.&lt;/p&gt;

&lt;p&gt;I extracted some valuable tips from my experience of writing and successfully delivering it to the target audience. I call it a success, because, with a marketing budget of ‚Ç¨0.00, it helped more than 250 web developers learn to make web apps more efficiently. In addition to that, it still brings me passive revenue every month, and it grew my professional network and consulting business.&lt;/p&gt;

&lt;h2 id=&quot;the-prerequisites-for-writing-an-e-book&quot;&gt;The prerequisites for writing an e-book&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;strong&gt;Know your field in depth&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;All humbleness aside, one ought to grow up and become an expert first. Know your stuff.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Have a knack for writing, form and story-telling&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Reading poor language and grammar destroys the experience. Nobody likes dull writing and genericism.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Be good at explaining&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;It‚Äôs easy to overestimate your mentoring abilites. Great tutoring is extremely hard.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Know your audience&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Do you know a community where there are at least 5 people who will buy your book right off the bat, or at least be very interested in? And I don‚Äôt mean your family. It‚Äôs the same as any other business. Do your market research.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Know your competitors&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;Has your book already been written by somebody else? In that case, do you know its drawbacks and have constructed a plan how your e-book will address that?&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Do it for the greater good&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;There is too much bullshit out there. Write material because you genuinely like doing it and because it will help people. Quick dollar and recognition should be treated as happy side-effects.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;center&gt;
&lt;blockquote class=&quot;twitter-tweet&quot; data-lang=&quot;en&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Just found out some company is building a web thing for US Paralympics and they‚Äôre using my book to learn &lt;a href=&quot;https://twitter.com/hashtag/emberjs?src=hash&quot;&gt;#emberjs&lt;/a&gt;! ü§ó&lt;a href=&quot;https://t.co/tv4BuDz1fF&quot;&gt;https://t.co/tv4BuDz1fF&lt;/a&gt;&lt;/p&gt;&amp;mdash; Matic Jurgliƒç (@matixmatix) &lt;a href=&quot;https://twitter.com/matixmatix/status/794460016602468352&quot;&gt;November 4, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;//platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/center&gt;

&lt;h2 id=&quot;tools&quot;&gt;Tools&lt;/h2&gt;

&lt;p&gt;Find an electronic book writing software that suits your needs. For example, if your book is about coding and includes computer code snippets, find something with a nice code syntax highlighter. Try to envision all the media material types that will be included, and choose accordingly.&lt;/p&gt;

&lt;p&gt;It‚Äôs very important the software you chose is able to export to a variety of formats. Of course, &lt;code class=&quot;highlighter-rouge&quot;&gt;.pdf&lt;/code&gt; is standard. A lot of people read on their e-readers, so make sure your writing software can spit out &lt;code class=&quot;highlighter-rouge&quot;&gt;.epub&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;.mobi&lt;/code&gt; formats. Don‚Äôt make the same rookie mistake as I did and write it in Pages (or MS Word). It will be an unmaintainable mess, and hard to export to a number of formats.&lt;/p&gt;

&lt;p&gt;If you don‚Äôt need anything special in that regards, there are some helpful e-book-creating services available, which can also act as a marketplace for your e-book. This is super helpful in case you don‚Äôt have an established following yet.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://leanpub.com/&quot;&gt;Leanpub&lt;/a&gt; offers integrated tooling for the whole journey: writing, publishing, marketing. Personally, I had great success with Leanpub, so I heavily recommend it. They‚Äôre promoting the books they think have potential (hint, hint: don‚Äôt be afraid to ask them to feature your e-book on their front page. You just might experience a spike in your sales on that day ü§ë ).&lt;/p&gt;

&lt;p&gt;There are other options, like &lt;a href=&quot;https://reedsy.com&quot;&gt;Reedsy&lt;/a&gt;, and &lt;a href=&quot;https://www.softcover.io/&quot;&gt;Softcover&lt;/a&gt;, which is more technical and needs more marketing setup.&lt;/p&gt;

&lt;h2 id=&quot;aesthetics-matter&quot;&gt;Aesthetics matter&lt;/h2&gt;

&lt;p&gt;The only popular books that can pull off a boring look is the Bible and O‚ÄôReilly books. So make sure to give your book an exciting cover.&lt;/p&gt;

&lt;p&gt;Here are some examples of rather boring e-book covers (that could make a potential reader wonder if the inside is equally dull ü§î):&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
  &lt;a href=&quot;https://leanpub.com/dowhatyoulove&quot;&gt;
    &lt;img src=&quot;/images/book-post/boring-book3.jpg&quot; /&gt;
    &lt;figcaption&gt;I can&#39;t even read the title.&lt;/figcaption&gt;
  &lt;/a&gt;
  &lt;a href=&quot;https://leanpub.com/whatsnewinjava8&quot;&gt;
	 &lt;img src=&quot;/images/book-post/boring-book2.jpg&quot; /&gt;
   &lt;figcaption&gt;Dry weed. Sounds good, right until you see this cover.&lt;/figcaption&gt;
  &lt;/a&gt;
  &lt;a href=&quot;https://leanpub.com/cstips&quot;&gt;
	 &lt;img src=&quot;/images/book-post/boring-book1.jpg&quot; /&gt;
   &lt;figcaption&gt;At least I can read the title.&lt;/figcaption&gt;
  &lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;Here are some examples of appealing e-book covers that make you wanna read it even though you have no idea what are they about:&lt;/p&gt;

&lt;figure class=&quot;third&quot;&gt;
  &lt;a href=&quot;https://leanpub.com/grumpy-phpunit&quot;&gt;
	 &lt;img src=&quot;/images/book-post/cool-cover1.jpg&quot; /&gt;
   &lt;figcaption&gt;Ha! Look at this frustrated elephant!&lt;/figcaption&gt;
  &lt;/a&gt;
  &lt;a href=&quot;https://leanpub.com/trailblazer&quot;&gt;
	 &lt;img src=&quot;/images/book-post/cool-cover2.jpg&quot; /&gt;
   &lt;figcaption&gt;Whoah, a crazy ride!&lt;/figcaption&gt;
  &lt;/a&gt;
  &lt;a href=&quot;https://leanpub.com/manualjornalismodigital&quot;&gt;
	 &lt;img src=&quot;/images/book-post/cool-cover3.jpg&quot; /&gt;
   &lt;figcaption&gt;So many cool looking things in shapes!&lt;/figcaption&gt;
  &lt;/a&gt;
&lt;/figure&gt;

&lt;p&gt;If you‚Äôre not a designing type, don‚Äôt worry. Pick some examples you like and ask your pixel savvy friend to help you out. Or, go to &lt;a href=&quot;https://www.fiverr.com/&quot;&gt;Fiverr&lt;/a&gt; and get one for 5 bucks.&lt;/p&gt;

&lt;h2 id=&quot;writing-tactics-for-upselling-and-getting-subscribers&quot;&gt;Writing tactics for upselling and getting subscribers&lt;/h2&gt;

&lt;p&gt;The point is to to get your readers‚Äô attention for a longer time period than just the duration of reading your e-book. To do that, introduce a few hooks in different sections of your e-book. Some ideas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;If you have a mailing list, Twitter, or a blog, pick the most interesting sections of your book and next to them, offer your readers to follow you there if they want to know more.&lt;/li&gt;
  &lt;li&gt;If you have another product (some other e-book, videos, a course,‚Ä¶), try to touch its topic in one of your sections, and paste the link.&lt;/li&gt;
  &lt;li&gt;Offer extra content your readers can unlock if they award you with your email and subscribe to your stuff.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You‚Äôre providing your readers with extra value, so don‚Äôt be afraid to throw a couple of these tricks inside your e-book.&lt;/p&gt;

&lt;h2 id=&quot;dedicated-website&quot;&gt;Dedicated website&lt;/h2&gt;

&lt;p&gt;If you‚Äôre serious about your indie e-book, it deserves to have &lt;a href=&quot;http://emberjs-book&quot;&gt;its own website&lt;/a&gt;, or its own section as a part of your existing website. This way, you‚Äôre in complete control of its SEO (and independent from other book markets, in case you chose to sell your book in any of them).&lt;/p&gt;

&lt;p&gt;Again, if your right brain hemisphere is underdeveloped, fear not. There is a big collection of good looking e-book website templates available on template markets. You can get one for cheap, fill in the copywriting and price, and you‚Äôre almost good to go. Include some real reader testimonials if you can.&lt;/p&gt;

&lt;p&gt;The only thing you need is a middleman that implements the payment infrastructure so you don‚Äôt have to deal with that. Probably the most popular service for that is &lt;a href=&quot;gumroad.com&quot;&gt;Gumroad&lt;/a&gt;. There you can upload your material and link it from your website. They take care of charging your reader and releasing them your material. You can configure coupons, promo codes, etc.&lt;/p&gt;

&lt;p&gt;Make sure to offer a chapter or two of your book for free. Let the reader input their email, and send them a free preview.&lt;/p&gt;

&lt;figure class=&quot;half&quot; style=&quot;text-align: center&quot;&gt;
    &lt;a href=&quot;http://emberjs-book.com&quot; style=&quot;margin: 0 auto&quot;&gt;&lt;img src=&quot;/images/book-post/free-pdf.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Put this on your website.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;I like this as I can ask people who decided not to buy the book what exactly turned them off.&lt;/p&gt;

&lt;h2 id=&quot;setting-the-price&quot;&gt;Setting the price&lt;/h2&gt;

&lt;p&gt;Pricing your e-book is tricky.&lt;/p&gt;

&lt;p&gt;Is it better to sell more copies for a cheaper price, or fewer for more? Finding a sweet spot in between not being perceived as cheap and not making your potential readers have second thoughts could be compared to predicting the stock market.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://signalvnoise.com/posts/3394-how-to-price-something&quot;&gt;Jason Fried&lt;/a&gt; made a fortune selling products online, and his advice is:&lt;/p&gt;

&lt;blockquote&gt;
  You can make up a number and see if it works.
&lt;/blockquote&gt;

&lt;p&gt;It‚Äôs good enough for a starting point, and you can always adjust it if you feel like you need it.&lt;/p&gt;

&lt;p&gt;Enabling multiple price brackets can increase conversions. It all depends on what you can offer together with your book. Have some videos, screencasts, or other material that could go with your book? Bundle it up and charge more than the price of your e-book alone.&lt;/p&gt;

&lt;p&gt;If you don‚Äôt have anything else to offer, you can sell your consulting. In my case, everything I could offer is my e-book and my knowledge, so I had to get a bit creative:&lt;/p&gt;

&lt;figure class=&quot;single&quot; style=&quot;text-align: center&quot;&gt;
    &lt;a href=&quot;http://emberjs-book.com&quot;&gt;&lt;img src=&quot;/images/book-post/pricing.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption style=&quot;width: 100%&quot;&gt;Come up with different packages.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Offering &lt;strong&gt;team licences&lt;/strong&gt; proved to be a good selling tactic.&lt;/p&gt;

&lt;p&gt;What I learned is that a lot of companies have money and want to do what is right. I never believed anybody will buy the third bracket, and I felt a bit sleazy adding it. It‚Äôs essentially the same thing, just with one small hour of my time added. It turned out I made quite a few of these &lt;strong&gt;‚ÄúExtra‚Äù&lt;/strong&gt; package sales. What‚Äôs even better, a lot of them didn‚Äôt ask for any consulting. And the best thing is that those few who asked for consulting, wanted to keep me around for extra help at a premium rate.&lt;/p&gt;

&lt;p&gt;Another lesson I learned is that people will buy your e-book even when there are free alternatives available, but you have to convince them that your material is superior and provides better value. It‚Äôs also in human nature to assign more value and worth to purchaseable products, compared to the free ones.&lt;/p&gt;

&lt;h2 id=&quot;launch-many-times&quot;&gt;Launch many times&lt;/h2&gt;

&lt;p&gt;After you launch your e-book, create many micro-launches.&lt;/p&gt;

&lt;p&gt;Added something new to the book? Create a fuss and share it all over. Holiday season? Offer a special holiday deal and let everybody know about it. This way you can push your sales and let people know your book is still up to date.&lt;/p&gt;

&lt;h2 id=&quot;team-up&quot;&gt;Team up&lt;/h2&gt;

&lt;p&gt;Another useful tactic is to team up with another author and sell your e-books combined for a discounted price. ‚ÄúGet more for less‚Äù, they say.&lt;/p&gt;

&lt;p&gt;In my case, I discovered that &lt;a href=&quot;http://thejsguy.com/&quot;&gt;David&lt;/a&gt; wrote a similar, but even more specialized &lt;a href=&quot;https://leanpub.com/emberdatainthewild&quot;&gt;e-book&lt;/a&gt;, and reached out to ask him if we can put our e-books in a bundle to sell them together for a lower price. Luckily, he was up for it, and after a few clicks on Leanpub, a new &lt;a href=&quot;https://leanpub.com/b/ember-bundle&quot;&gt;Ember Bundle&lt;/a&gt; was born. Apparently, readers like the combo, and the sales went up again üòé.&lt;/p&gt;

&lt;figure class=&quot;half&quot; style=&quot;text-align: center&quot;&gt;
    &lt;a href=&quot;https://leanpub.com/b/ember-bundle&quot; style=&quot;margin: 0 auto&quot;&gt;&lt;img src=&quot;/images/book-post/bundle.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Our bundle on Leanpub.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;its-hard&quot;&gt;It‚Äôs hard&lt;/h2&gt;

&lt;p&gt;Niche e-books usually reach hit or fad popularity, which means a low chance of on-going revenue after you are finished, especially in tech and marketing, where things move quickly. So, given how much work you‚Äôre planning to sink into it, you need to decide if it‚Äôs worth it.&lt;/p&gt;

&lt;p&gt;While writing it, I found myself so caught up in the details that I could &lt;strong&gt;no longer imagine how anybody could find my e-book useful&lt;/strong&gt;. The mental burden of delivering valuable and correct educational stuff nearly eradicated my will to finish it. When inspiration diminished, grit and discipline helped me push through.&lt;/p&gt;

&lt;p&gt;In the end, it was all worth it.&lt;/p&gt;

&lt;p&gt;&lt;small&gt; Special thanks to &lt;a href=&quot;https://twitter.com/artto&quot;&gt;@artto&lt;/a&gt; for designing the e-book‚Äôs cover and Katherine from Russia for reviewing this article. &lt;/small&gt;&lt;/p&gt;</content><category term="posts" /><summary>Write material because you genuinely like doing it and because it will help people. Quick dollar should be treated as a happy side-effect.</summary></entry><entry><title>Dynamic CSS in Ember templates</title><link href="/posts/dynamic-css-in-ember-templates/" rel="alternate" type="text/html" title="Dynamic CSS in Ember templates" /><published>2016-11-12T00:00:00+01:00</published><updated>2016-11-12T00:00:00+01:00</updated><id>/posts/dynamic-css-in-ember-templates</id><content type="html" xml:base="/posts/dynamic-css-in-ember-templates/">&lt;p&gt;Recently I was challenged with a task to dynamically colorize checkboxes when they are selected. The colors are generated on-the-fly when the select action is triggered:&lt;/p&gt;

&lt;iframe src=&quot;//giphy.com/embed/qeUvEToKvHGBa&quot; width=&quot;400&quot; height=&quot;250&quot; frameborder=&quot;0&quot; class=&quot;giphy-embed&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;&lt;small&gt;Finished functionality. It‚Äôs a selector for chart series.&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Since we generate colors dynamically and thus can‚Äôt make predefined CSS classes that determine the checkbox‚Äôs color, I thought it should be enough to simply inline the color style, like so:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;{{#&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;chartSeries&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkbox&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;input&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;checkbox&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;html-safe&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;concat&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#39;color:&#39;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;checked=‚Ä¶&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;label&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;for=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;seriesId&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;
      &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;lt;/label&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;{{/&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;&lt;small&gt;Random color is set to the the &lt;code class=&quot;highlighter-rouge&quot;&gt;series.color&lt;/code&gt; property on checkbox change event.&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;Due to the way these custom checkboxes are implemented, I learned this is not going to work. The place to define checkbox‚Äôs background color is actually in the label‚Äôs &lt;code class=&quot;highlighter-rouge&quot;&gt;::before&lt;/code&gt; pseudo selector:&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/dynamic-css-post/1.jpg&quot;&gt;&lt;img src=&quot;/images/dynamic-css-post/1.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;You can&#39;t implement pseudo-element declarations using inline CSS.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;lesson-1-css-is-not-designed-to-accept-pseudo-element-styles-in-the-style-attribute&quot;&gt;Lesson 1: CSS is not designed to accept pseudo-element styles in the style attribute.&lt;/h2&gt;

&lt;p&gt;What can we do?&lt;/p&gt;

&lt;p&gt;The only solution that came to my mind is to generate CSS classes dynamically. I naively wrote this piece of code in the template, and for some reason, I didn‚Äôt expect it to work:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;style&amp;gt;&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{#&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;chartSeries&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;
    input[type=&quot;checkbox&quot;]#&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;seriesId&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;.styled:checked + label:before {
      background: &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;
      border-color: &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;
    }
  &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;{{/&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}}&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/style&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;But it did. I was amazed by how Ember‚Äôs templating engine digests this without problems, and dynamically adds the necessary CSS declarations to the &lt;code class=&quot;highlighter-rouge&quot;&gt;style&lt;/code&gt; tag when the &lt;code class=&quot;highlighter-rouge&quot;&gt;chartSeries&lt;/code&gt; array changes:&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/dynamic-css-post/2.jpg&quot;&gt;&lt;img src=&quot;/images/dynamic-css-post/2.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;The templating engine inserts some whitespace, but we can live with that.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;lesson-2-when-you-need-a-dirty-workaround-embers-templating-engine-can-reactively-spit-out-practically-any-markup-a-browser-can-understand&quot;&gt;Lesson 2: When you need a dirty workaround, Ember‚Äôs templating engine can reactively spit out practically any markup a browser can understand.&lt;/h2&gt;

&lt;p&gt;Just be careful not to ruin your site‚Äôs performance.&lt;/p&gt;

&lt;p&gt;In our case, every time the &lt;code class=&quot;highlighter-rouge&quot;&gt;chartSeries&lt;/code&gt; array changes, the browser needs to recalculate style, which could lead to page clunkiness if we had a lot of elements and a lot of updates in a short amount of time.&lt;/p&gt;</content><category term="posts" /><summary>When you need a dirty workaround, Ember&#39;s templating engine can reactively spit out practically any markup a browser can understand.</summary></entry><entry><title>Making a concrete fibonacci clock</title><link href="/posts/concrete-fibonacci-clock/" rel="alternate" type="text/html" title="Making a concrete fibonacci clock" /><published>2016-11-06T00:00:00+01:00</published><updated>2016-11-06T00:00:00+01:00</updated><id>/posts/concrete-fibonacci-clock</id><content type="html" xml:base="/posts/concrete-fibonacci-clock/">&lt;p&gt;The idea of the Fibonacci clock is a brainchild of &lt;a href=&quot;http://basbrun.com/&quot;&gt;Philippe Chr√©tien&lt;/a&gt;, who calls his creation ‚Äúa clock for nerds with style‚Äù. It‚Äôs certainly not a very practical clock, but the fusion of the curious numerical sequence with a lighting installation aesthetic is just too appealing to look away.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8108.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8108.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8110.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8110.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;My concrete fibonacci clock in action. It&#39;s supposed to tell time...&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;To tell the time on this timepiece, you need to use some brains. There‚Äôs an equation (check out &lt;a href=&quot;https://www.kickstarter.com/projects/basbrun/fibonacci-clock-an-open-source-clock-for-nerds-wit&quot;&gt;this link&lt;/a&gt; for more details) where you use numbers related to which chamber is lit with which color. Here‚Äôs an example:&lt;/p&gt;

&lt;figure&gt;
    &lt;a href=&quot;/images/fibonacci/instructions.png&quot;&gt;&lt;img src=&quot;/images/fibonacci/instructions.png&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;The screen of the clock is made up of five squares whose side lengths match the first five Fibonacci numbers: 1, 1, 2, 3 and 5.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Phillipe is offering finished products in pretty wooden casings, but I needed to add one extra dimension: &lt;strong&gt;brutality&lt;/strong&gt;. Let‚Äôs make this thing out of concrete! I purchased the electronics part (LEDs and the controller) only, and used them for my interpretation of the clock.&lt;/p&gt;

&lt;h2 id=&quot;make-a-mold&quot;&gt;Make a mold&lt;/h2&gt;

&lt;p&gt;For molding of my concrete projects I often use Styrodur (a brand of extruded polystyrene) which I find to be the perfect tradeoff between the ease of handling and rigidness for holding shape (for smaller objects at least). The pieces are glued together.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
     &lt;a href=&quot;/images/fibonacci/IMG_6769.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_6769.jpg&quot; /&gt;&lt;/a&gt;
     &lt;a href=&quot;/images/fibonacci/IMG_6802.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_6802.jpg&quot; /&gt;&lt;/a&gt;
     &lt;figcaption&gt;The idea is to make a box where the concrete is simply poured in, and when the concrete &quot;dries up&quot;, the mold is taken apart, which leaves us with a shaped brick.&lt;/figcaption&gt;
 &lt;/figure&gt;

&lt;h2 id=&quot;pour-the-concrete-into-the-mold&quot;&gt;Pour the concrete into the mold&lt;/h2&gt;
&lt;p&gt;I use a mixture of standard cement, sand, water. Adding reinforcement is crucial, otherwise the concrete brick falls apart and cracks. In this case I used glass fiber, but I‚Äôm regretting it, because the fibers make the the surface of the concrete look bad (tiny stripes and scars). I should have just used good old steel reinforcement.&lt;/p&gt;

&lt;p&gt;This amount of concrete is surprisingly heavy (weight of a small child), and somehow I didn‚Äôt fully account for that during the process. As I was pouring the concrete in the mold, the outer walls started to bend. Yikes! I needed a quick way to ensure the walls stay straight using whatever I could find in that moment. Behold the various things holding it together.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_6819.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_6819.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_6821 2.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_6821 2.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;The insides are coated with vegetable oil for easier dismantling.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;take-the-brick-out-of-the-mold&quot;&gt;Take the brick out of the mold&lt;/h2&gt;

&lt;p&gt;There‚Äôs nothing sweeter than the smell of freshly cured concrete in the morning. I tore the skeleton apart, and found this beauty underneath. To get the wiring through, holes were drilled in the inner walls.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_6827.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_6827.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_7784.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_7784.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;You can see glass fibre on the edges. It‚Äôs effective for strength, but looks ugly on the surface.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;Did you know it can take up to 20 years for the concrete to fully harden and settle?&lt;/p&gt;

&lt;h2 id=&quot;attach-acrylic-glass&quot;&gt;Attach acrylic glass&lt;/h2&gt;

&lt;p&gt;With a jig saw, I cut the covers out of an acrylic glass sheet, drilled the holes for the bolts and attached the nuts:&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_7786.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_7786.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_7810.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_7810.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Test fit.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;sand-and-color&quot;&gt;Sand and color&lt;/h2&gt;

&lt;p&gt;Time to sand this sucker down and make it smooth. The amount of dust generated while sanding concrete is colossal and disgusting. The brick was then coated with a protective waterproofer.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_7937.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_7937.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8062.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8062.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;I didn&#39;t like the look of the silver bolts, so I decided to paint them black.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;h2 id=&quot;finish-up&quot;&gt;Finish up&lt;/h2&gt;

&lt;p&gt;To project as much light as possible onto the acrylic sheets from the LEDs behind, I made an internal wooden enclosure and covered it with aluminum reflective foil. Let‚Äôs also add some legs, so the clock won‚Äôt leave scrathes all over the place.&lt;/p&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8060.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8060.jpg&quot; /&gt;&lt;/a&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8064.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8064.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Almost done.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;figure class=&quot;half&quot;&gt;
    &lt;a href=&quot;/images/fibonacci/IMG_8095.jpg&quot;&gt;&lt;img src=&quot;/images/fibonacci/IMG_8095.jpg&quot; /&gt;&lt;/a&gt;
    &lt;figcaption&gt;Done.&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;The clock also comes with a secret mode that continuously flashes through a vast spectre of colors. A real feast for the eyes.&lt;/p&gt;

&lt;iframe src=&quot;//giphy.com/embed/DkghEwh3sVz6E&quot; width=&quot;480&quot; height=&quot;270&quot; frameborder=&quot;0&quot; class=&quot;giphy-embed&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;</content><category term="posts" /><summary>Not a very practical clock, but the fusion of the curious numerical sequence with a lighting installation aesthetic is just too appealing to look away.</summary></entry><entry><title>Recurring subscription payments: use external service or make your own?</title><link href="/posts/subscription-payments-use-external-service-or-make-your-own/" rel="alternate" type="text/html" title="Recurring subscription payments: use external service or make your own?" /><published>2016-09-19T00:00:00+02:00</published><updated>2016-09-19T00:00:00+02:00</updated><id>/posts/subscription-payments-use-external-service-or-make-your-own</id><content type="html" xml:base="/posts/subscription-payments-use-external-service-or-make-your-own/">&lt;p&gt;Billing is far more complex than people tend to believe, and much more so with subscriptions.&lt;/p&gt;

&lt;blockquote class=&quot;twitter-tweet tw-align-center&quot; data-lang=&quot;en&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Remind me to never make a subscription service again.&lt;/p&gt;&amp;mdash; Jeffrey Biles (@JeffreyBiles) &lt;a href=&quot;https://twitter.com/JeffreyBiles/status/775371558768390144&quot;&gt;September 12, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;//platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;center&gt;&lt;small&gt;I feel your pain, Jeffrey. It&#39;s hard to get it right.&lt;/small&gt;&lt;/center&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;Subscriptions are a common business model in paid online products, especially in SaaS world. That means the customers are charged in a recurring fashion; most commonly monthly or yearly.&lt;/p&gt;

&lt;p&gt;After you convinced your customer to enter their payment vehicle (credit card, PayPal, etc), there are two ways you can trigger acquiring currency when their payment is due:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Use an external billing service (&lt;a href=&quot;https://www.braintreegateway.com/&quot;&gt;Braintree&lt;/a&gt;, &lt;a href=&quot;https://recurly.com/product/&quot;&gt;Recurly&lt;/a&gt;, &lt;a href=&quot;https://stripe.com&quot;&gt;Stripe&lt;/a&gt;, &lt;a href=&quot;https://cheddargetter.com/&quot;&gt;Chedargetter&lt;/a&gt;,‚Ä¶) and let it do &lt;strong&gt;all&lt;/strong&gt; the billing work. Let it charge your customers on a recurring basis and send you event notifications, which you use to update your system - prolong or expire customers‚Äô subscription. Simple, fast, reliable, but severely limited in customization as your business needs grow.&lt;/li&gt;
  &lt;li&gt;Also use one of the billing services*, but only manually - implement your own payment scheduler (usually with a cron job or a run loop) and bill the customers using your own server. Periodically use the payment service‚Äôs API to bill customers, and handle all the results yourself. It‚Äôs more complex and bug prone, takes more time to implement, but you‚Äôre in complete control and know exactly how your billing system works, especially when something breaks.
&lt;br /&gt;&lt;br /&gt;&lt;span&gt;*&lt;/span&gt; &lt;small&gt;assuming you‚Äôre offloading PCI responsibility to a payment processor by only storing customer tokens on your server instead of raw payment method data. &lt;/small&gt;
¬†&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So, what does this recurring work actually include? The most basic flow is this: every month,&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;determine&lt;/strong&gt; payment amount depending on customer‚Äôs subscription plan,&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;charge&lt;/strong&gt; the amount using their payment method,&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;update&lt;/strong&gt; their subscription in your application‚Äôs database,&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;send&lt;/strong&gt; an invoice.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;you-need-to-decide-what-kind-of-billing-mechanics-your-business-needs&quot;&gt;You need to decide what kind of billing mechanics your business needs.&lt;/h2&gt;

&lt;p&gt;&lt;span style=&quot;margin-top: 20px; display: inline-block;&quot;&gt;Let‚Äôs compare both ways a little bit more in depth.&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Using option 1, you populate the external service with your subscription plans, add-ons, coupons and perhaps configure trial periods. When customers subscribe to your product, your application registers them to the billing service. It takes care of deducting your customers‚Äô money every month/year and sending it to your wallet. For every payment activity (successful charge, declined card, etc), they send an event notification, usually as HTTP requests to your API - also known as ‚Äúreverse API‚Äù. You use these notifications to extend or halt your customers‚Äô subscriptions.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;The main benefit here is that you spend very little time developing a billing system.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;When you are just starting out, or when you‚Äôre certain your billing dynamics aren‚Äôt going to be very diverse, implementing your own billing system is most probably a waste of time. This way you usually also get some basic billing analytics with it, which is really useful for monitoring customer and revenue churn rates.&lt;/p&gt;

&lt;h2 id=&quot;as-your-business-grows-things-can-quickly-get-complicated&quot;&gt;As your business grows, things can quickly get complicated.&lt;/h2&gt;

&lt;p&gt;&lt;span style=&quot;margin-top: 20px; display: inline-block;&quot;&gt;Consider diverse subscription plans, coupons and add-ons with variable durations and prices depending on various conditions, multi-currency, multi-tenancy and dunning.&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Let‚Äôs list some examples.&lt;/p&gt;

&lt;p&gt;What if‚Ä¶&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;a customer decides to upgrade from a monthly to a yearly subscription in the middle of the month, and you have some custom rules for a pro-rate refund?&lt;/li&gt;
  &lt;li&gt;a coupon is valid only for an upgrade to a larger subscription?&lt;/li&gt;
  &lt;li&gt;there is a second trial period for some customers?&lt;/li&gt;
  &lt;li&gt;an add-on is cheaper on a larger subscription plan?&lt;/li&gt;
  &lt;li&gt;there is a special discount for people paying with a debit visa card?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;See the pattern?&lt;/p&gt;

&lt;p&gt;In cases like this, you can‚Äôt escape having a custom tailored business logic for determining the amount to charge. As your pricing plans become more convoluted with discounting, optional add-ons and conditionals it becomes hard not just to bill, but also to keep track of activities, ordering, and reporting.&lt;/p&gt;

&lt;center&gt;&lt;img src=&quot;http://i.imgur.com/cLU8h3D.png&quot; alt=&quot;RankTrackr Billing&quot; title=&quot;RankTrackr billing&quot; style=&quot;width: 520px; margin-top: 20px;&quot; /&gt;&lt;/center&gt;
&lt;center&gt;&lt;small&gt;At &lt;a href=&quot;http://ranktrackr.com&quot;&gt;RankTrackr&lt;/a&gt; we built a custom billing service. It runs every day at 10AM and shows the results in Slack. &lt;/small&gt;&lt;/center&gt;

&lt;p&gt;&lt;br /&gt;
&lt;span style=&quot;margin-top: 15px; display: block;&quot;&gt;Subscription payments are one of the most delicate parts of your online business, so do your homework, because migrating to a different subscription payment implementation is distressing and expensive.&lt;/span&gt;&lt;/p&gt;</content><category term="posts" /><summary>Billing is far more complex than people tend to believe, and much more so with subscriptions.</summary></entry></feed>
